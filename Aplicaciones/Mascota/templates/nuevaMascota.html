{% extends './plantilla.html' %}
{% block contenido %}

<div class="row">
    <div class="col-md-3"></div>

    <div class="col-md-6">
        <h1 class="text-center">Nueva Mascota</h1>

        <form action="{% url 'guardarMascota' %}" 
              method="post" 
              enctype="multipart/form-data" 
              id="frmNuevaMascota">
            {% csrf_token %}

            <!-- CÓDIGO -->
            <label for="codigo">Código</label>
            <input class="form-control" type="text" name="codigo" id="codigo" maxlength="50">
            <br>

            <!-- NOMBRE -->
            <label for="nombre">Nombre</label>
            <input class="form-control" type="text" name="nombre" id="nombre" maxlength="200">
            <br>

            <!-- ESPECIE -->
            <label for="especie">Especie</label>
            <select class="form-control" name="especie" id="especie">
                <option value="">Seleccione una especie</option>
                {% for valor, etiqueta in especies %}
                    <option value="{{ valor }}">{{ etiqueta }}</option>
                {% endfor %}
            </select>
            <br>

            <!-- EDAD -->
            <label for="edad">Edad</label>
            <input class="form-control" type="number" name="edad" id="edad" min="0" max="30">
            <br>

            <!-- IMAGEN -->
            <label for="imgMascota">Imagen de la Mascota</label>
            <input id="imgMascota" name="imgMascota" type="file" class="file">
            <br><br>

            <a class="btn btn-danger" href="{% url 'inicio' %}">Cancelar</a>
            <button type="submit" class="btn btn-success">Guardar</button>
        </form>
    </div>

    <div class="col-md-3"></div>
</div>

<!-- VALIDACIONES -->
<script>
$(document).ready(function() {
    $('#frmNuevaMascota').validate({
        rules: {
            "codigo": {
                required: true,
                maxlength: 50
            },
            "nombre": {
                required: true,
                maxlength: 200
            },
            "especie": {
                required: true
            },
            "edad": {
                required: true,
                min: 0,
                max: 30
            },
            "imgMascota": {
                required: true
            }
        },
        messages: {
            "codigo": {
                required: "Ingrese el código de la mascota.",
                maxlength: "Máximo 50 caracteres."
            },
            "nombre": {
                required: "Ingrese el nombre de la mascota.",
                maxlength: "Máximo 200 caracteres."
            },
            "especie": {
                required: "Seleccione una especie."
            },
            "edad": {
                required: "Ingrese la edad.",
                min: "Debe ser un número positivo.",
                max: "Edad no válida."
            },
            "imgMascota": {
                required: "Debe subir una imagen."
            }
        }
    });

    // Inicializar fileinput
    $("#imgMascota").fileinput({
        language: "es",
        allowedFileExtensions: ["png", "jpg", "jpeg"],
        showCaption: false,
        dropZoneEnabled: true,
        showClose: false,
        maxFileSize: 2048 // 2 MB
    });
});
</script>

{% endblock %}

