{% extends './plantilla.html' %}
{% block contenido %}

<div class="container">
<h1>Listado de adopciones realizadas</h1>

<a href="{% url 'nuevaAdopcion' %}" class="btn btn-primary">Agregar nueva adopcion</a>
<br><br>

<table class="table table-border table-striped table-hover" id="tbl_ado">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nombre Adoptante</th>
            <th>Correo</th>
            <th>Telefono</th>
            <th>Mascota</th>
            <th>Fecha</th>
            <th>Estado</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for adopcion in adopciones %}
        <tr>
            <td>{{ adopcion.id }}</td>
            <td>{{ adopcion.nombre_adoptante }}</td>
            <td>{{ adopcion.correo }}</td>
            <td>{{ adopcion.telefono }}</td>
            <td>{{ adopcion.mascota.nombre }}</td>
            <td>{{ adopcion.fecha }}</td>
            <td>{{ adopcion.estado }}</td>
            <td>
                <a href="{% url 'editarAdopcion' adopcion.id %}" class="btn btn-outline-warning">
                    <i class="fa fa-pen"></i>
                </a>
                <a href="{% url 'eliminarAdopcion' adopcion.id %}" class="btnEliminar btn btn-outline-danger" data-id="{{ adopcion.id }}">
                    <i class="fa fa-trash"></i>
                </a>

                {% if adopcion.estado == 'pendiente' %}
                    <a href="{% url 'aceptarAdopcion' adopcion.id %}" class="btn btn-outline-success">Aceptar</a>
                    <a href="{% url 'rechazarAdopcion' adopcion.id %}" class="btn btn-outline-secondary">Rechazar</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const botonesEliminar = document.querySelectorAll(".btnEliminar");
    botonesEliminar.forEach(boton => {
        boton.addEventListener("click", function (e) {
            e.preventDefault(); 
            const url = this.getAttribute("href");
            Swal.fire({
                title: "Estas seguro?",
                text: "Una vez eliminado no hay vuelta atras",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Si, eliminar",
                cancelButtonText: "Cancelar"
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = url; 
                }
            });
        });
    });
});

$(document).ready(function () {
    let table = new DataTable('#tbl_ado', {
        language: { url: 'https://cdn.datatables.net/plug-ins/2.3.1/i18n/es-ES.json' },
        dom: 'lBfrtip',
        pageLength: 3,
        buttons: [
          { extend: 'copy', text: 'Copiar', className: 'btn btn-primary me-2' },
          { extend: 'csv', text: 'CSV', className: 'btn btn-info me-2' },
          { extend: 'excel', text: 'Excel', className: 'btn btn-success me-2' },
          { extend: 'pdf', text: 'PDF', className: 'btn btn-danger me-2' },
          { extend: 'print', text: 'Imprimir', className: 'btn btn-secondary me-2' }
        ]
    });
});
</script>

{% endblock %}


